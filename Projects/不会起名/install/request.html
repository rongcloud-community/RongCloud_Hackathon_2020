<html>
<head>
<META HTTP-EQUIV="content-type" CONTENT="text/html; charset=utf-8">
<title>TaokeOCS安装</title>
<link href="css.css" rel="stylesheet" type="text/css">
<script language=javascript>
<!--

NS4 = (document.layers) ? 1 : 0;
IE4 = (document.all) ? 1 : 0;
ver4 = (NS4 || IE4) ? 1 : 0;

if (ver4) 
{
	with (document) 
	{
        	write("<STYLE TYPE='text/css'>");
        	if (NS4) 
        	{
            		write(".parent {position:absolute; visibility:visible; margin:0px;}");
            		write(".child {position:absolute; visibility:visible; margin:0px;}");
            		write(".regular {position:absolute; visibility:visible; margin:0px;}")
        	}
        	else 
        	{
            		write(".child {display:none; margin:0px;}")
        	}
        	write("</STYLE>");
    	}
}
//检查是否支持上传组件
function checkIfSupportJspUpload()
{ 
	var sResult=null;//页面返回结果
	var xmlObj=null;
	url="supportJspUpload.jsp";
	try{  
		
	  	try{xmlObj = new ActiveXObject("Microsoft.XMLHTTP"); }catch(e){ xmlObj = new XMLHttpRequest();}
	  	if(xmlObj){    
			xmlObj.onreadystatechange=function(){
		 		//alert(xmlObj.readyState);
				//alert(sResult);
		 		if(xmlObj.readyState==4){
		  			//alert(xmlObj.status);
		  			if (xmlObj.status==200 ) {//404 没有访问的页面		  			 
		   				sResult=xmlObj.responseText;              
		   				//if(sResult!=null && sResult!="")						 					 
						if(sResult.indexOf("successful")>=0) 
							document.getElementById("supportJspUpload").innerText +="成功";							 
						else
							document.getElementById("supportJspUpload").innerText +="失败"; 								 
		  			}	
					else
						document.getElementById("supportJspUpload").innerText +="失败";	 		  			            
		  			xmlObj=null;	
					document.getElementById("next").style.display="inline";	
		 		}
			}
			xmlObj.open("GET",url,true); //同步请求
			xmlObj.send();
	  	}
	  	else{	 		//alert("该浏览器无法建立控件");
			document.getElementById("supportJspUpload").innerText +="失败";		  	
		}
 	}catch(e){   	  		//alert("网页访问失败");
		xmlObj=null;	
		document.getElementById("supportJspUpload").innerText +="失败";	
 	}  
	
}
//检测是否支持数据库
function checkIfSupportJspDatabase()
{ 
	var sResult=null;//页面返回结果
	var xmlObj=null;
	url="supportJspDatabase.jsp";
	try{  
		
	  	try{xmlObj = new ActiveXObject("Microsoft.XMLHTTP"); }catch(e){ xmlObj = new XMLHttpRequest();}
	  	if(xmlObj){    
			xmlObj.onreadystatechange=function(){
		 		//alert(xmlObj.readyState);
				//alert(sResult);
		 		if(xmlObj.readyState==4){
		  			//alert(xmlObj.status);
		  			if (xmlObj.status==200 ) {//404 没有访问的页面		  			 
		   				sResult=xmlObj.responseText;              
		   				//if(sResult!=null && sResult!="")						 					 
						if(sResult.indexOf("successful")>=0) 
							document.getElementById("supportJspDb").innerText +="成功";							 
						else
							document.getElementById("supportJspDb").innerText +="失败"; 								 
		  			}	
					else
						document.getElementById("supportJspDb").innerText +="失败";	 		  			            
		  			xmlObj=null;					 
					setTimeout('checkIfSupportJspUpload()',2000);				
		 		}
			}
			xmlObj.open("GET",url,true); //同步请求
			xmlObj.send();
	  	}
	  	else{	 		//alert("该浏览器无法建立控件");
			document.getElementById("supportJspDb").innerText +="失败";		  	
		}
 	}catch(e){   	  		//alert("网页访问失败");
		xmlObj=null;	
		document.getElementById("supportJspDb").innerText +="失败";	
 	}  
	
}
//检测是否支持文件写入
function checkIfSupportJspWrite()
{ 
	var sResult=null;//页面返回结果
	var xmlObj=null;
	url="supportJspWrite.jsp";
	try{  
		
	  	try{xmlObj = new ActiveXObject("Microsoft.XMLHTTP"); }catch(e){ xmlObj = new XMLHttpRequest();}
	  	if(xmlObj){    
			xmlObj.onreadystatechange=function(){
		 		//alert(xmlObj.readyState);
				//alert(sResult);
		 		if(xmlObj.readyState==4){
		  			//alert(xmlObj.status);
		  			if (xmlObj.status==200 ) {//404 没有访问的页面		  			 
		   				sResult=xmlObj.responseText;              
		   				//if(sResult!=null && sResult!="")							
						if(sResult.indexOf("successful")>=0) 
							document.getElementById("supportJspWrite").innerText +="成功";
						else
							document.getElementById("supportJspWrite").innerText +="失败";		 								 
		  			}	
					else
						document.getElementById("supportJspWrite").innerText +="失败";				 		  			            
		  			xmlObj=null;						 
					setTimeout('checkIfSupportJspDatabase()',2000);					
		 		}
			}
			xmlObj.open("GET",url,true); //同步请求
			xmlObj.send();
	  	}
	  	else{	 		//alert("该浏览器无法建立控件");
			document.getElementById("supportJspWrite").innerText +="失败";		  	
		}
 	}catch(e){   	  		//alert("网页访问失败");
		xmlObj=null;	
		document.getElementById("supportJspWrite").innerText +="失败";	
 	}  
	
}
//检测是否支持jsp
function checkIfSupportJsp()
{ 
	var sResult=null;//页面返回结果
	var xmlObj=null;
	url="supportJsp.jsp";
	try{  
		
	  	try{xmlObj = new ActiveXObject("Microsoft.XMLHTTP"); }catch(e){ xmlObj = new XMLHttpRequest();}
	  	if(xmlObj){    
			xmlObj.onreadystatechange=function(){
		 		//alert(xmlObj.readyState);
				//alert(sResult);
		 		if(xmlObj.readyState==4){
		  			//alert(xmlObj.status);
		  			if (xmlObj.status==200 ) {//404 没有访问的页面		  			 
		   				sResult=xmlObj.responseText;              
		   				//if(sResult!=null && sResult!="")	
						if(sResult.indexOf("successful")>=0) 
							document.getElementById("supportJsp").innerText +="成功";
						else
							document.getElementById("supportJsp").innerText +="失败";			 								 
		  			}	
					else
						document.getElementById("supportJsp").innerText +="失败";				 		  			            
		  			xmlObj=null;
					//进入下一个检测	
					setTimeout('checkIfSupportJspWrite()',2000);				
		 		}
			}
			xmlObj.open("GET",url,true); //同步请求
			xmlObj.send();
	  	}
	  	else{	 		//alert("该浏览器无法建立控件");
			document.getElementById("supportJsp").innerText +="失败";		  	
			//进入下一个检测	
			checkIfSupportJspWrite();	
		}
 	}catch(e){   	  		//alert("网页访问失败");
		xmlObj=null;	
		document.getElementById("supportJsp").innerText +="失败";	
		//进入下一个检测	
		checkIfSupportJspWrite();	
 	}  
	
}

//-->
</script>
</head>


<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" class="b-border">
  <tr> 
    <td bgcolor="FC9D39"><img src="images/spacer.gif" width="1" height="6"></td>
  </tr>
</table>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr>
    <td width="220" valign="top" background="images/leftbg.gif"><table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#496B7A">
        <tr>
          <td height="201" align="center" bgcolor="#FFFFFF"><a href="http://www.shopex.cn" target="_blank"></a>
              <SCRIPT LANGUAGE="JavaScript" src="corp.js"></SCRIPT>
              <img src="images/N27_3.jpg" width="136" height="71"></td>
        </tr>
      </table>
        <table width="100%" border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td><img src="images/leftmenutop.gif" width="226" height="6"></td>
          </tr>
          <tr>
            <td valign="top"><table width="213" border="0" cellpadding="0" cellspacing="0" class="p9white">
                <tr>
                  <td width="218" height="3" align="right"><table width="100%" border="0" cellspacing="0" cellpadding="0">
                      <tr>
                        <td bgcolor="#52617B"><img src="images/spacer.gif" width="1" height="1"></td>
                      </tr>
                  </table></td>
                </tr>
              </table>
                <table width="213" border="0" cellpadding="2" cellspacing="2" class="p9white">
                  <tr>
                    <td width="218" align="right" class="p12white"><img src="images/items.gif" width="11" height="11"> 安装准备</td>
                  </tr>
                </table>
              <table width="213" border="0" cellpadding="0" cellspacing="0" class="p9white">
                  <tr>
                    <td width="218" height="3" align="right"><table width="100%" border="0" cellspacing="0" cellpadding="0">
                        <tr>
                          <td bgcolor="#52617B"><img src="images/spacer.gif" width="1" height="1"></td>
                        </tr>
                    </table></td>
                  </tr>
              </table>
              <table width="213" border="0" cellpadding="2" cellspacing="2" class="p9white">
                  <tr>
                    <td width="218" align="right" ><a class="menu" href="home.htm"> 简介</a></td>
                  </tr>
                  <tr>
                    <td align="right" class="menu"><a class="menu" href="index.htm">-&gt;</a><a class="menu" href="require.htm"> 安装说明</a></td>
                  </tr>
              </table>
              <table width="213" border="0" cellpadding="2" cellspacing="2" class="p9white">
                  <tr>
                    <td width="94%" align="right"><a class="menu" href="request.html">系统检测</a></td>
                  </tr>
              </table>
              <table width="213" border="0" cellpadding="0" cellspacing="0" class="p9white">
                  <tr>
                    <td width="218" height="3" align="right"><table width="100%" border="0" cellspacing="0" cellpadding="0">
                        <tr>
                          <td bgcolor="#52617B"><img src="images/spacer.gif" width="1" height="1"></td>
                        </tr>
                    </table></td>
                  </tr>
              </table>
              <table width="213" border="0" cellpadding="2" cellspacing="2" class="p9white">
                  <tr>
                    <td width="218" align="right" class="p12white"><img src="images/items.gif" width="11" height="11"> 开始安装</td>
                  </tr>
              </table>
              <table width="213" border="0" cellpadding="0" cellspacing="0" class="p9white">
                  <tr>
                    <td width="218" height="3" align="right"><table width="100%" border="0" cellspacing="0" cellpadding="0">
                        <tr>
                          <td bgcolor="#52617B"><img src="images/spacer.gif" width="1" height="1"></td>
                        </tr>
                    </table></td>
                  </tr>
              </table>
              <table width="213" border="0" cellpadding="2" cellspacing="2" class="p9white">
                  <tr>
                    <td align="right"><a href="dbinstall.html" class="menu">开始安装</a></td>
                  </tr>
                  <tr>
                    <td align="right"><a href="ini_setup.html" class="menu">客户信息设定及数据初始化</a></td>
                  </tr>
                  <tr>
                    <td align="right"><a href="ok.html" class="menu">完成</a></td>
                  </tr>
              </table></td>
          </tr>
          <tr>
            <td><img src="images/leftmenubottom.gif" width="226" height="6"></td>
          </tr>
        </table>
        <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#496B7A">
          <tr>
            <td height="201" align="center" bgcolor="#FFFFFF"><a href="http://www.shopex.cn" target="_blank"></a>
            </td>
          </tr>
      </table></td> 
    <td width="794" valign="top"> <table width="100%" border="0" cellpadding="0" cellspacing="0" background="images/topbg.gif" class="lrborder">
        <tr> 
          <td width="46%" height="55"><img src="images/toppic-1.gif" width="366" height="55"></td>
          <td width="54%" align="right"><img src="images/topinfo-2.gif" width="176" height="55"></td>
        </tr>
      </table>
      <br> 
	  
      <table width="95%" border="0" align="center" cellpadding="0" cellspacing="0" class="p9gray">
        <tr> 
          <td valign="top"> <TABLE cellSpacing="0" cellPadding="0" width="95%" align="center" border="0">
            <TBODY>
              <TR>
                <TD vAlign="top"><p>系统检测结果:<BR>
                  <div id="supportJsp">1.检查支持程序（JSP） ...</div> 
                  <div id="supportJspWrite">2.检查目录及文件权限（文件写入权限）...</div>
                  <div id="supportJspDb">3.检查数据库支持（MySQL）...</div>
                  <div id="supportJspUpload">4.检查上传文件方式...</div>
                  </TR>
            </TBODY>
          </TABLE>            <p><br>
<script language=javascript>
<!-- 	
	 checkIfSupportJsp(); 
//-->
</script>
              <br>
            </p>          </td>
        </tr>
        <tr>
          <td align="center" valign="top"><input name="Button2" type="button" class="inputstyle" onClick="location='index.htm'" value=" 上一步 "> 
            <input id="next" style="display:none" name="Button" type="button" class="inputstyle" onClick="location='dbinstall.html'" value=" 下一步 ">
            <input name="Button22" type="button" class="inputstyle" onClick="window.close()" value="取消"></td>
        </tr>
      </table>
      <p>&nbsp;</p></td>
  </tr>
</table>
</body>
</html>